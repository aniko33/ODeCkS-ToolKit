from re import L
from pyzbar.pyzbar import decode
import cv2
import zlib
import base45
import cbor2
from cose.messages import CoseMessage
from cose.headers import Algorithm, KID
import json
from urllib.request import urlopen
filename = input("Filename > ")
img = cv2.imread(filename)
gray_img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
decoded = decode(gray_img)
payload = decoded[0].data[4:]
line="+------------------------------------+"
decoded = base45.b45decode(payload)
decompressed = zlib.decompress(decoded)
cose = CoseMessage.decode(decompressed)
print(line)
print(cose)
print(line)
data = cbor2.loads(cose.payload)
print(data)
print(line)
